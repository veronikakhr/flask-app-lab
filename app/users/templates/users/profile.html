{% extends 'base.html' %}
{% set theme = request.cookies.get('theme', 'light') %}

{% block title %}Профіль{% endblock %}

{% block content %}
<div class="{{ theme }} p-3 rounded">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>Ласкаво просимо до сторінки, {{ user }}!</h2>
        <a href="{{ url_for('users.logout') }}" class="btn btn-danger">Вийти</a>
    </div>
    <p>Тут ви можете отримати інформацію та вийти з системи.</p>

    <hr>

    <div class="row">
        <div class="col-md-6">
            <h4>Додати кукі:</h4>
            <form action="{{ url_for('users.add_cookie') }}" method="POST">
                <div class="mb-3">
                    <label for="key" class="form-label">Ключ кукі</label>
                    <input type="text" class="form-control" id="key" name="key" placeholder="Наприклад, my_key">
                </div>
                <div class="mb-3">
                    <label for="value" class="form-label">Значення кукі</label>
                    <input type="text" class="form-control" id="value" name="value" placeholder="Наприклад, my_value">
                </div>
                <div class="mb-3">
                    <label for="expiry" class="form-label">Термін дії (сек)</label>
                    <input type="number" class="form-control" id="expiry" name="expiry" value="3600">
                </div>
                <button type="submit" class="btn btn-success">Додати кукі</button>
            </form>
        </div>

        <div class="col-md-6">
            <h4>Видалити кукі за ключем:</h4>
            <form action="{{ url_for('users.delete_cookie_key') }}" method="POST" class="mb-4">
                <div class="mb-3">
                    <label for="key_to_delete" class="form-label">Ключ кукі для видалення </label>
                    <input type="text" class="form-control" id="key_to_delete" name="key_to_delete">
                </div>
                <button type="submit" class="btn btn-warning">Видалити за ключем </button>
            </form>
            
            <hr>

            <h4>Видалити всі кукі: </h4>
            <form action="{{ url_for('users.delete_all_cookies') }}" method="POST">
                <button type="submit" class="btn btn-danger">Видалити всі кукі</button>
            </form>
        </div>
    </div>

    <h4 class="mt-5">Список всіх кукі:</h4>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col">Ключ</th>
                <th scope="col">Значення</th>
            </tr>
        </thead>
        <tbody>
        {% if cookies %}
            {% for key, value in cookies.items() %}
            <tr>
                <td>{{ key }}</td>
                <td>{{ value|truncate(80) }}</td> 
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="2">Кукі не знайдено.</td>
            </tr>
        {% endif %}
        </tbody>
    </table>
    <hr>
    
    <h4 class="mt-5">Змінити кольорову схему:</h4>
    <a href="{{ url_for('users.change_theme') }}" class="btn btn-secondary">
        Перемкнути на {% if theme == 'light' %}Темну{% else %}Світлу{% endif %} тему
    </a>
    </div> {% endblock %}